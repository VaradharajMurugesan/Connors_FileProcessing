2024-11-20 21:56:31.9356 [DEBUG] Application Starting 
2024-11-20 21:56:48.1419 [INFO] Downloaded file: EmployeeEntity-2024-308-2024-342.csv.gz to D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payroll/Mapping\EmployeeEntity-2024-308-2024-342.csv.gz 
2024-11-20 21:56:48.9182 [ERROR] Failed to reprocess D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payroll/FailedFiles\Payfile_2024-10-20-2024-11-02_2024-11-04 16_00_26 -0800_20241120_215648.csv System.IO.IOException: The process cannot access the file 'D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payroll\Mapping\EmployeeEntity-2024-308-2024-342.csv' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize)
   at System.IO.Strategies.FileStreamHelpers.ChooseStrategyCore(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize)
   at System.IO.Strategies.FileStreamHelpers.ChooseStrategy(FileStream fileStream, String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, Int64 preallocationSize)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access)
   at ProcessFiles_Demo.SFTPExtract.SFTPFileExtract.ExtractGzFile(String gzFilePath, String outputFilePath) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\SFTPExtract\SFTPFileExtract.cs:line 85
   at ProcessFiles_Demo.SFTPExtract.SFTPFileExtract.DownloadAndExtractFile(JObject clientSettings, String remoteDirectoryPath, String localDirectoryPath) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\SFTPExtract\SFTPFileExtract.cs:line 57
   at ProcessFiles_Demo.FileProcessing.PayrollFileProcessor..ctor(JObject clientSettings) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\FileProcessing\PayrollProcessor.cs:line 30
   at ProcessFiles_Demo.FileProcessing.CsvFileProcessorFactory.GetProcessor(String processortype, JObject clientSettings) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\FileProcessing\CsvFileProcessorFactory.cs:line 25
   at Program.ProcessReprocessingFilesAsync(IFileTransferClient fileTransferClient, String processor_type, String reprocessingFolder, String processedFolder, String failedFolder, String outputFolder, String decryptedFolderOutput, JObject clientSettings) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\Program.cs:line 194
2024-11-20 21:56:49.0486 [INFO] ERROR: The process cannot access the file 'D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payroll\Mapping\EmployeeEntity-2024-308-2024-342.csv' because it is being used by another process. - moved to FailedFiles. 
2024-11-20 21:57:12.4601 [ERROR] Error processing files from FTP/SFTP System.IO.FileNotFoundException: Could not find file 'D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payfile_2024-10-20-2024-11-02_2024-11-04 16_00_26 -0800.csv'.
File name: 'D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payfile_2024-10-20-2024-11-02_2024-11-04 16_00_26 -0800.csv'
   at System.IO.File.Move(String sourceFileName, String destFileName, Boolean overwrite)
   at System.IO.File.Move(String sourceFileName, String destFileName)
   at Program.MoveFileToFolder(String sourceFilePath, String destinationFolder) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\Program.cs:line 225
   at Program.FetchAndProcessFilesAsync(IFileTransferClient fileTransferClient, String processor_type, String processedFolder, String reprocessingFolder, String outputFolder, String decryptedFolderOutput, JObject clientSettings) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\Program.cs:line 148
2024-11-20 21:57:12.4601 [INFO] ERROR: Could not find file 'D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payfile_2024-10-20-2024-11-02_2024-11-04 16_00_26 -0800.csv'. 
2024-11-20 21:57:12.4601 [INFO] Application Completed Successfully 
2024-11-20 21:59:33.1262 [DEBUG] Application Starting 
2024-11-20 21:59:49.6229 [INFO] Downloaded file: EmployeeEntity-2024-308-2024-342.csv.gz to D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payroll/Mapping\EmployeeEntity-2024-308-2024-342.csv.gz 
2024-11-20 21:59:50.4429 [ERROR] Failed to reprocess D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payroll/FailedFiles\Payfile_2024-10-20-2024-11-02_2024-11-04 16_00_26 -0800_20241120_215950.csv System.IO.IOException: The process cannot access the file 'D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payroll\Mapping\EmployeeEntity-2024-308-2024-342.csv' because it is being used by another process.
   at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)
   at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize)
   at System.IO.Strategies.OSFileStreamStrategy..ctor(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize)
   at System.IO.Strategies.FileStreamHelpers.ChooseStrategyCore(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize)
   at System.IO.Strategies.FileStreamHelpers.ChooseStrategy(FileStream fileStream, String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, Int64 preallocationSize)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access)
   at ProcessFiles_Demo.SFTPExtract.SFTPFileExtract.ExtractGzFile(String gzFilePath, String outputFilePath) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\SFTPExtract\SFTPFileExtract.cs:line 85
   at ProcessFiles_Demo.SFTPExtract.SFTPFileExtract.DownloadAndExtractFile(JObject clientSettings, String remoteDirectoryPath, String localDirectoryPath) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\SFTPExtract\SFTPFileExtract.cs:line 57
   at ProcessFiles_Demo.FileProcessing.PayrollFileProcessor..ctor(JObject clientSettings) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\FileProcessing\PayrollProcessor.cs:line 30
   at ProcessFiles_Demo.FileProcessing.CsvFileProcessorFactory.GetProcessor(String processortype, JObject clientSettings) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\FileProcessing\CsvFileProcessorFactory.cs:line 25
   at Program.ProcessReprocessingFilesAsync(IFileTransferClient fileTransferClient, String processor_type, String reprocessingFolder, String processedFolder, String failedFolder, String outputFolder, String decryptedFolderOutput, JObject clientSettings) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\Program.cs:line 194
2024-11-20 21:59:50.5117 [INFO] ERROR: The process cannot access the file 'D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payroll\Mapping\EmployeeEntity-2024-308-2024-342.csv' because it is being used by another process. - moved to FailedFiles. 
2024-11-20 22:00:13.7248 [ERROR] Error processing files from FTP/SFTP System.IO.FileNotFoundException: Could not find file 'D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payfile_2024-10-20-2024-11-02_2024-11-04 16_00_26 -0800.csv'.
File name: 'D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payfile_2024-10-20-2024-11-02_2024-11-04 16_00_26 -0800.csv'
   at System.IO.File.Move(String sourceFileName, String destFileName, Boolean overwrite)
   at System.IO.File.Move(String sourceFileName, String destFileName)
   at Program.MoveFileToFolder(String sourceFilePath, String destinationFolder) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\Program.cs:line 225
   at Program.FetchAndProcessFilesAsync(IFileTransferClient fileTransferClient, String processor_type, String processedFolder, String reprocessingFolder, String outputFolder, String decryptedFolderOutput, JObject clientSettings) in D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\Program.cs:line 148
2024-11-20 22:00:13.7248 [INFO] ERROR: Could not find file 'D:\Emergere\ConnorsLLC\ConnorsLLC_Project\ProcessFiles_Demo\bin\Debug\net6.0\Payfile_2024-10-20-2024-11-02_2024-11-04 16_00_26 -0800.csv'. 
2024-11-20 22:00:13.7248 [INFO] Application Completed Successfully 
